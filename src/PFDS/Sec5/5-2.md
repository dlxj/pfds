# 演習問題 5.2

> 二項ヒープの `insert` が$O(1)$ 償却時間で実行されることを銀行家法を用いて示す。

物理学者法: 二項ヒープのポテンシャルをヒープの木の数としていた。

銀行家法の方針: ヒープ中の各木に対して貯金を1ずつ割り当てる。

`insert` の呼び出しは k+1 ステップかかる。（ただし k は `link` の呼び出し回数）

このとき、k 個の木を消費しているので貯金は k 減少、1 個の木を生んでいるので貯金は 1 増加する。

そのため、償却コストは $a_i = t_i + c_i - \overline{c_i} = (k+1) + 1 - k = 2$ となる。 

## 補足

木の有無を 2 進数表現してみる。

例えば要素数 11 の二項ヒープは $(1011)_2$ と表現できる。

`insert` を呼び出すことは $(1011)_2 + (1)_2 = (1100)_2$ という計算に似ている。

このとき、繰り上がりが連鎖している。これをスロー再生してみよう。

$(1011)_2 + (1)_2$

$= (1011_{+1})_2$		-- $(1_{+1})_2$ はその位に 1 が足されようとしていることを表す

$= (101_{+1}0)_2$ 	-- 1 の位の値は 0 になり、繰り上がった 1 が 2 の位に足されようとしている（貯金 - 1） 

$= (10_{+1}00)_2$ 	-- 2 の位の値は 0 になり、繰り上がった 1 が 4 の位に足されようとしている（貯金 - 1） 

$= (1100)_2$ 		-- 4 の位の値が 1 になった（貯金 + 1） 

ここで、`link` が呼び出される回数こそが、繰り上がりの回数、すなわち貯金が減る回数を表している。