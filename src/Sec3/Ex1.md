# PFDS 演習問題 3.1

**[memo] 左偏性: 任意の左の子のランクが右の子と同じかそれ以上である**

サイズ $n$ の左偏ヒープの右スパインが、高々$\lfloor {\rm log}_2 (n+1) \rfloor$ 個の要素しか持たないことを示す。

↓ 対偶

右スパインが $\lfloor {\rm log}_2 (n+1) \rfloor$ 個より多くの要素を持つとき、サイズ $n$ の左偏ヒープを構成することはできない。

### $n = 2^k-1\ (k\in\mathbb{Z}_0)$ と表せるとき

$$
\lfloor {\rm log}_2 (n+1) \rfloor = \lfloor {\rm log}_2 (2^k-1+1)\rfloor = \lfloor k\rfloor = k
$$

なので、$k+1$ 要素の右スパインを持つ左偏ヒープを構成することを考える。

任意のノードにおいて、左の子が右の子のランクと同じかそれ以上となるように構成すると、それは高さ $k+1$ の完全二分ヒープ（？）であり、要素数は
$$
2^{k+1}-1=2\cdot 2^k-1=2n+1>n\quad (n\ge 0)
$$
となるため、そのような左偏ヒープを構成することはできない。

### $n\ne 2^k-1\ (k\in\mathbb{Z}_0,\ k>1)$ と表せるとき

$$
k-1 < {\rm log}_2 (2^{k-1}+1) \leq \lfloor {\rm log}_2 (n+1) \rfloor <k\quad (2^{k-1}\le n\lt 2^k-1)
$$

なので、$k$ 要素の右スパインを持つ左偏ヒープを構成することを考える。

任意のノードにおいて、左の子が右の子のランクと同じかそれ以上となるように構成すると、それは高さ $k$ の完全二分ヒープにいくつかノードを加えた左偏ヒープである。ただし、最右ノードに右の子を加えないことに注意。

このヒープの要素数を $e$ とすると、$e>2^k-1>n$ となるため、そのような左偏ヒープを構成することはできない。