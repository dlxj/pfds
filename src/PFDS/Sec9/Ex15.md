# 演習問題 9.15

> 以下の補題 9.2 を示す。
>
> $t$ がランク $r$ のねじれ二項木であるとき、 $2^r \le |t| \le 2^{r+1} - 1$

まず、 $2^r \le |t|$ であることは、ねじれ二項木のすべての部分木における Elem.T list が空であるとき、通常の二項木と一致することから明らか。

次に、 $|t| \le 2^{r+1} - 1$ を示す。 
ランク $n$ のねじれ二項木が、すべての部分木における Elem.T list に最大まで要素を持つ場合を考える。
このときのねじれ二項木のサイズを $a_n$ で表すと、
$$
\begin{eqnarray}
a_n & = & （要素） & + & （要素のリスト） & + & （ランク n-1 のねじれ二項木のリスト） \\
    & = & 1 & + & n & + & a_{n-1} + \cdots + a_0
\end{eqnarray}
$$

ここで、 $a_{n+1}$ を考えると、
$$
\begin{eqnarray}
a_{n+1}       & = & 1 & + & n & + & 1 + a_n & + a_{n-1} + \cdots + a_0 \\
a_n           & = & 1 & + & n &   &         & + a_{n-1} + \cdots + a_0 \\ \hline
a_{n+1} - a_n & = &   &   &   &   & 1 + a_n &   &
\end{eqnarray}
$$

整理して、
$$
a_{n+1} = 2a_n + 1
$$
特性方程式 $x = 2x + 1$ の根 $x = -1$ を用いて変形し、
$$
a_{n+1} + 1 = 2(a_n + 1)
$$
これは初項 $a_1 + 1 = 2a_0 + 1 = 2 \cdot 1 + 1 = 3$ 、等比 $2$ の等比数列なので、
$$
a_n + 1 = 4 \cdot 2^{n-1} = 2^{n+1}
$$
よって一般項は、
$$
a_n = 2^{n+1} - 1
$$
ゆえに、題意は示された。